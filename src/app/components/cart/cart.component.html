<div class="cart-content">
  <ng-container *ngIf="items.length > 0; else emptyCart">
    <mat-card *ngFor="let item of items" class="cart-item">
      <img
        mat-card-image
        [src]="getImageUrl(item.nomeImagem)"
        [alt]="item.nome"
        class="product-image"
        (error)="onImageError($event)"
      />

      <mat-card-content>
        <h3 class="item-name">{{ item.nome }}</h3>
        <p class="item-price">
          {{ item.preco | currency: 'BRL':'symbol':'1.2-2' }}
        </p>

        <div class="quantity-control">
          <button
            mat-mini-button
            color="primary"
            (click)="updateItemQuantity(item, item.quantidade - 1)"
          >
            <mat-icon>remove</mat-icon>
          </button>

          <input
            matInput
            type="number"
            [(ngModel)]="item.quantidade"
            (change)="updateItemQuantity(item, item.quantidade)"
            min="1"
            class="quantity-input"
          />

          <button
            mat-mini-button
            color="primary"
            (click)="updateItemQuantity(item, item.quantidade + 1)"
          >
            <mat-icon>add</mat-icon>
          </button>
        </div>

        <p class="item-total">
          Total:
          {{
            (item.preco * item.quantidade) | currency: 'BRL':'symbol':'1.2-2'
          }}
        </p>
      </mat-card-content>

      <mat-card-actions>
        <button
          mat-icon-button
          color="warn"
          aria-label="Remover item"
          (click)="removeItem(item.id)"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </mat-card-actions>
    </mat-card>
  </ng-container>

  <ng-template #emptyCart>
    <div class="empty-cart">
      <mat-icon class="empty-cart-icon">shopping_cart</mat-icon>
      <p>Seu carrinho est√° vazio</p>
      <a mat-raised-button color="primary" routerLink="/produtos">
        Explorar Produtos
      </a>
    </div>
  </ng-template>
</div>

<mat-divider *ngIf="items.length > 0"></mat-divider>

<div class="sidenav-footer" *ngIf="items.length > 0">
  <div class="subtotal">
    <span>Subtotal:</span>
    <span>{{ subtotal | currency: 'BRL':'symbol':'1.2-2' }}</span>
  </div>

  <button mat-raised-button color="primary" (click)="finalizePurchase()">
    Finalizar Compra
  </button>

  <button mat-stroked-button color="warn" (click)="clearCart()">
    Limpar Carrinho
  </button>
</div>
